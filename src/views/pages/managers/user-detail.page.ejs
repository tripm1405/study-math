<div class="h-full w-full">
    <h1 style="margin-bottom: 20px; color: #333;">Chi tiết tài khoản</h1>
        <form id="form" action="/users">
            
            <div class="mb-3">
                <label for="code" class="form-label">Mã tài khoản</label>
                <input 
                    id="code"
                    name="code" 
                    type="text" 
                    value="<%= data?.user?.code %>" 
                    placeholder="Code..." 
                    <%= data?.user?.code && 'disabled' %> 
                    class="form-control"
                />
            </div>
            <div class="mb-3">
                <label for="username" class="form-label">Tên tài khoản</label>
                <input 
                    id="username"
                    name="username" 
                    type="text" 
                    value="<%= data?.user?.username %>" 
                    placeholder="Username..." 
                    class="form-control"
                />
            </div>
            <div class="mb-3">
                <label for="password" class="form-label">Mật khẩu</label>
                <input 
                    id="password"
                    name="password" 
                    type="password" 
                    value="<%= data?.user?.password %>" 
                    placeholder="Password..." 
                    class="form-control"
                />
            </div>
            <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input 
                    id="email"
                    name="email" 
                    type="email" 
                    value="<%= data?.user?.email %>" 
                    placeholder="Email..." 
                    class="form-control"
                />
            </div>
            <div class="mb-3">
                <label for="type" class="form-label">Quyền truy cập</label>
                <select 
                    id="type" 
                    name="type" 
                    class="form-select"
                >
                    <option value="Teacher" <%= data?.user?.type === 'Teacher' && 'selected' %>>Giáo viên</option>
                    <option value="Student" <%= data?.user?.type === 'Student' && 'selected' %>>Học sinh</option>
                </select>
            </div>
            <div style="display: flex; justify-content: flex-end;">
                <button type="submit" class="btn btn-primary">Lưu</button>
            </div>
        </form>
</div>

<input type="hidden" id="id" value="<%= data?.user?._id %>" />
<input type="hidden" id="method" value="<%= data?.user?._id ? 'PUT' : 'POST' %>" />

<script>
    const method = document.getElementById('method').value;
    const id = document.getElementById('id').value;

    document.getElementById('form').addEventListener('submit', async event => {
        event.preventDefault();

        const formData = new FormData(event.target);

        try {
            if (method === 'PUT') {
                await axios.put(`http://localhost:5500/users/${id}`, formData, {
                    headers: { 'Content-Type': 'multipart/form-data' }
                });
            } else {
                await axios.post('http://localhost:5500/users', formData, {
                    headers: { 'Content-Type': 'multipart/form-data' }
                });
            }
            window.location.href = '/users';
        } catch (error) {
            console.error('There was an error!', error);
        }
    });
</script>